jobs:
  include:
  - language: dart
    dist: xenial
    addons:
      apt:
        packages:
          - lib32stdc++6
    install:
      - git clone https://github.com/flutter/flutter.git -b stable
      - ./flutter/bin/flutter doctor
      - gem install coveralls-lcov
    script:
      -
      - ./flutter/bin/flutter test --coverage
    after_success:
      # - coverage report --omit 'lib/core/select_payment'
      - coveralls-lcov coverage/lcov.info
    cache:
      directories:
        - $HOME/.pub-cache
  
  - language: android
    dist: trusty
    android:
      components:
        - tools
        - platform-tools
        - build-tools-26.0.2
        - android-26
        - extra
      licenses:
        - 'android-sdk-preview-license-52d11cd2'
        - 'android-sdk-license-.+'
        - 'google-gdk-license-.+'
      script:
        - ./gradlew assemble lint
      before_script:
        - echo no | android create avd --force -n test -t android-19 --abi armeabi-v7a
        - emulator -avd test -no-skin -no-audio -no-window &
        - android-wait-for-emulator
        - adb shell input keyevent 82 &
        - ./gradlew build connectedCheck